{"ast":null,"code":"import { ref } from 'vue';\nimport axios from 'axios';\nimport { useRoute, useRouter } from 'vue-router';\nimport { FontAwesomeIcon } from '@fortawesome/vue-fontawesome';\nimport { faStar } from '@fortawesome/free-solid-svg-icons';\nexport default {\n  name: \"DiaryDetail\",\n  components: {\n    'font-awesome-icon': FontAwesomeIcon\n  },\n  setup() {\n    const route = useRoute();\n    const router = useRouter();\n    const diary = ref({}); // 存储日记详情\n\n    // 从路由参数中获取日记详情\n    const fetchDiaryDetail = async () => {\n      const diaryData = JSON.parse(route.query.diary);\n      diary.value = diaryData;\n      await updatePopularity(diary.value.content);\n    };\n\n    //更细日记热度\n    const updatePopularity = async diaryContent => {\n      try {\n        const response = await axios.post('/api/diary-popularity', {\n          content: diaryContent\n        });\n        if (response.data.success) {\n          // 假设后端返回新的热度值\n          diary.value.popularity = response.data.popularity;\n          console.log('热度更新成功');\n        } else {\n          console.error('更新热度失败:', response.data.message);\n        }\n      } catch (err) {\n        console.error('更新热度时发生错误:', err);\n      }\n    };\n\n    // 返回按钮\n    const goBack = () => {\n      router.go(-1); // 返回上一页\n    };\n\n    // 初始化获取日记详情\n    fetchDiaryDetail();\n    return {\n      diary,\n      goBack\n    };\n  }\n};","map":{"version":3,"names":["ref","axios","useRoute","useRouter","FontAwesomeIcon","faStar","name","components","setup","route","router","diary","fetchDiaryDetail","diaryData","JSON","parse","query","value","updatePopularity","content","diaryContent","response","post","data","success","popularity","console","log","error","message","err","goBack","go"],"sources":["D:\\Users\\SevenGrass\\Documents\\WILLIAMZHANG\\DataStrucCourseDes\\MyGithub\\src_all\\frontend\\src\\components\\DiaryDetail.vue"],"sourcesContent":["<template>\r\n    <div class=\"diary-detail\">\r\n        <h1>{{ diary.title }}</h1>\r\n        <p>作者：{{ diary.author }}</p>\r\n        <p>描述对象：{{ diary.description }}</p>\r\n        <p>内容：</p>\r\n        <div v-html=\"diary.content\"></div>\r\n        <p>热度：{{ diary.popularity }}</p>\r\n        <p>评分：{{ diary.rating }}</p>\r\n        <!-- 评分组件 -->\r\n        <div class=\"rating\">\r\n            <span v-for=\"rating in ratings\" :key=\"rating\" @click=\"setRating(rating)\">\r\n                <i class=\"fa fa-star\" :class=\"{ 'star-active': rating <= currentRating }\"></i>\r\n            </span>\r\n        </div>\r\n        <button @click=\"submitRating\">提交评分</button>\r\n        <button @click=\"goBack\">返回</button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport axios from 'axios';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { FontAwesomeIcon } from '@fortawesome/vue-fontawesome';\r\nimport { faStar } from '@fortawesome/free-solid-svg-icons';\r\n\r\nexport default {\r\n    name: \"DiaryDetail\",\r\ncomponents: {\r\n        'font-awesome-icon': FontAwesomeIcon\r\n    },\r\n    setup() {\r\n        const route = useRoute();\r\n        const router = useRouter();\r\n        const diary = ref({}); // 存储日记详情\r\n\r\n        // 从路由参数中获取日记详情\r\n        const fetchDiaryDetail = async () => {\r\n            const diaryData = JSON.parse(route.query.diary);\r\n            diary.value = diaryData;\r\n\r\n            await updatePopularity(diary.value.content);\r\n        };\r\n\r\n        //更细日记热度\r\n        const updatePopularity = async (diaryContent) => {\r\n            try {\r\n                const response = await axios.post('/api/diary-popularity', {\r\n                    content: diaryContent\r\n                });\r\n                if (response.data.success) {\r\n                    // 假设后端返回新的热度值\r\n                    diary.value.popularity = response.data.popularity;\r\n                    console.log('热度更新成功');\r\n                } else {\r\n                    console.error('更新热度失败:', response.data.message);\r\n                }\r\n            } catch (err) {\r\n                console.error('更新热度时发生错误:', err);\r\n            }\r\n        };\r\n\r\n        // 返回按钮\r\n        const goBack = () => {\r\n            router.go(-1); // 返回上一页\r\n        };\r\n\r\n        // 初始化获取日记详情\r\n        fetchDiaryDetail();\r\n\r\n        return {\r\n            diary,\r\n            goBack,\r\n        };\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped></style>"],"mappings":"AAqBA,SAASA,GAAE,QAAS,KAAK;AACzB,OAAOC,KAAI,MAAO,OAAO;AACzB,SAASC,QAAQ,EAAEC,SAAQ,QAAS,YAAY;AAChD,SAASC,eAAc,QAAS,8BAA8B;AAC9D,SAASC,MAAK,QAAS,mCAAmC;AAE1D,eAAe;EACXC,IAAI,EAAE,aAAa;EACvBC,UAAU,EAAE;IACJ,mBAAmB,EAAEH;EACzB,CAAC;EACDI,KAAKA,CAAA,EAAG;IACJ,MAAMC,KAAI,GAAIP,QAAQ,CAAC,CAAC;IACxB,MAAMQ,MAAK,GAAIP,SAAS,CAAC,CAAC;IAC1B,MAAMQ,KAAI,GAAIX,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;;IAEvB;IACA,MAAMY,gBAAe,GAAI,MAAAA,CAAA,KAAY;MACjC,MAAMC,SAAQ,GAAIC,IAAI,CAACC,KAAK,CAACN,KAAK,CAACO,KAAK,CAACL,KAAK,CAAC;MAC/CA,KAAK,CAACM,KAAI,GAAIJ,SAAS;MAEvB,MAAMK,gBAAgB,CAACP,KAAK,CAACM,KAAK,CAACE,OAAO,CAAC;IAC/C,CAAC;;IAED;IACA,MAAMD,gBAAe,GAAI,MAAOE,YAAY,IAAK;MAC7C,IAAI;QACA,MAAMC,QAAO,GAAI,MAAMpB,KAAK,CAACqB,IAAI,CAAC,uBAAuB,EAAE;UACvDH,OAAO,EAAEC;QACb,CAAC,CAAC;QACF,IAAIC,QAAQ,CAACE,IAAI,CAACC,OAAO,EAAE;UACvB;UACAb,KAAK,CAACM,KAAK,CAACQ,UAAS,GAAIJ,QAAQ,CAACE,IAAI,CAACE,UAAU;UACjDC,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;QACzB,OAAO;UACHD,OAAO,CAACE,KAAK,CAAC,SAAS,EAAEP,QAAQ,CAACE,IAAI,CAACM,OAAO,CAAC;QACnD;MACJ,EAAE,OAAOC,GAAG,EAAE;QACVJ,OAAO,CAACE,KAAK,CAAC,YAAY,EAAEE,GAAG,CAAC;MACpC;IACJ,CAAC;;IAED;IACA,MAAMC,MAAK,GAAIA,CAAA,KAAM;MACjBrB,MAAM,CAACsB,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE;IACnB,CAAC;;IAED;IACApB,gBAAgB,CAAC,CAAC;IAElB,OAAO;MACHD,KAAK;MACLoB;IACJ,CAAC;EACL;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}