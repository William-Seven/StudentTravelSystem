{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"diary-detail\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"p\", null, \"内容：\", -1 /* HOISTED */);\nconst _hoisted_3 = [\"innerHTML\"];\nconst _hoisted_4 = {\n  class: \"rating\"\n};\nconst _hoisted_5 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"h1\", null, _toDisplayString($setup.diary.title), 1 /* TEXT */), _createElementVNode(\"p\", null, \"作者：\" + _toDisplayString($setup.diary.author), 1 /* TEXT */), _createElementVNode(\"p\", null, \"描述对象：\" + _toDisplayString($setup.diary.description), 1 /* TEXT */), _hoisted_2, _createElementVNode(\"div\", {\n    innerHTML: $setup.diary.content\n  }, null, 8 /* PROPS */, _hoisted_3), _createElementVNode(\"p\", null, \"热度：\" + _toDisplayString($setup.diary.popularity), 1 /* TEXT */), _createElementVNode(\"p\", null, \"评分：\" + _toDisplayString($setup.diary.rating), 1 /* TEXT */), _createCommentVNode(\" 评分组件 \"), _createElementVNode(\"div\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.ratings, rating => {\n    return _openBlock(), _createElementBlock(\"span\", {\n      key: rating,\n      onClick: $event => _ctx.setRating(rating)\n    }, [_createElementVNode(\"i\", {\n      class: _normalizeClass([\"fa fa-star\", {\n        'star-active': rating <= _ctx.currentRating\n      }])\n    }, null, 2 /* CLASS */)], 8 /* PROPS */, _hoisted_5);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => _ctx.submitRating && _ctx.submitRating(...args))\n  }, \"提交评分\"), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $setup.goBack && $setup.goBack(...args))\n  }, \"返回\")]);\n}","map":{"version":3,"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_toDisplayString","$setup","diary","title","author","description","_hoisted_2","innerHTML","content","_hoisted_3","popularity","rating","_createCommentVNode","_hoisted_4","_Fragment","_renderList","_ctx","ratings","key","onClick","$event","setRating","_normalizeClass","currentRating","_hoisted_5","_cache","args","submitRating","goBack"],"sources":["D:\\Users\\SevenGrass\\Documents\\WILLIAMZHANG\\DataStrucCourseDes\\MyGithub\\src_all\\frontend\\src\\components\\DiaryDetail.vue"],"sourcesContent":["<template>\r\n    <div class=\"diary-detail\">\r\n        <h1>{{ diary.title }}</h1>\r\n        <p>作者：{{ diary.author }}</p>\r\n        <p>描述对象：{{ diary.description }}</p>\r\n        <p>内容：</p>\r\n        <div v-html=\"diary.content\"></div>\r\n        <p>热度：{{ diary.popularity }}</p>\r\n        <p>评分：{{ diary.rating }}</p>\r\n        <!-- 评分组件 -->\r\n        <div class=\"rating\">\r\n            <span v-for=\"rating in ratings\" :key=\"rating\" @click=\"setRating(rating)\">\r\n                <i class=\"fa fa-star\" :class=\"{ 'star-active': rating <= currentRating }\"></i>\r\n            </span>\r\n        </div>\r\n        <button @click=\"submitRating\">提交评分</button>\r\n        <button @click=\"goBack\">返回</button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue';\r\nimport axios from 'axios';\r\nimport { useRoute, useRouter } from 'vue-router';\r\nimport { FontAwesomeIcon } from '@fortawesome/vue-fontawesome';\r\nimport { faStar } from '@fortawesome/free-solid-svg-icons';\r\n\r\nexport default {\r\n    name: \"DiaryDetail\",\r\ncomponents: {\r\n        'font-awesome-icon': FontAwesomeIcon\r\n    },\r\n    setup() {\r\n        const route = useRoute();\r\n        const router = useRouter();\r\n        const diary = ref({}); // 存储日记详情\r\n\r\n        // 从路由参数中获取日记详情\r\n        const fetchDiaryDetail = async () => {\r\n            const diaryData = JSON.parse(route.query.diary);\r\n            diary.value = diaryData;\r\n\r\n            await updatePopularity(diary.value.content);\r\n        };\r\n\r\n        //更细日记热度\r\n        const updatePopularity = async (diaryContent) => {\r\n            try {\r\n                const response = await axios.post('/api/diary-popularity', {\r\n                    content: diaryContent\r\n                });\r\n                if (response.data.success) {\r\n                    // 假设后端返回新的热度值\r\n                    diary.value.popularity = response.data.popularity;\r\n                    console.log('热度更新成功');\r\n                } else {\r\n                    console.error('更新热度失败:', response.data.message);\r\n                }\r\n            } catch (err) {\r\n                console.error('更新热度时发生错误:', err);\r\n            }\r\n        };\r\n\r\n        // 返回按钮\r\n        const goBack = () => {\r\n            router.go(-1); // 返回上一页\r\n        };\r\n\r\n        // 初始化获取日记详情\r\n        fetchDiaryDetail();\r\n\r\n        return {\r\n            diary,\r\n            goBack,\r\n        };\r\n    },\r\n};\r\n</script>\r\n\r\n<style scoped></style>"],"mappings":";;EACSA,KAAK,EAAC;AAAc;gCAIrBC,mBAAA,CAAU,WAAP,KAAG;mBALd;;EAUaD,KAAK,EAAC;AAAQ;mBAV3B;;uBACIE,mBAAA,CAgBM,OAhBNC,UAgBM,GAfFF,mBAAA,CAA0B,YAAAG,gBAAA,CAAnBC,MAAA,CAAAC,KAAK,CAACC,KAAK,kBAClBN,mBAAA,CAA4B,WAAzB,KAAG,GAAAG,gBAAA,CAAGC,MAAA,CAAAC,KAAK,CAACE,MAAM,kBACrBP,mBAAA,CAAmC,WAAhC,OAAK,GAAAG,gBAAA,CAAGC,MAAA,CAAAC,KAAK,CAACG,WAAW,kBAC5BC,UAAU,EACVT,mBAAA,CAAkC;IAA7BU,SAAsB,EAAdN,MAAA,CAAAC,KAAK,CAACM;0BAN3BC,UAAA,GAOQZ,mBAAA,CAAgC,WAA7B,KAAG,GAAAG,gBAAA,CAAGC,MAAA,CAAAC,KAAK,CAACQ,UAAU,kBACzBb,mBAAA,CAA4B,WAAzB,KAAG,GAAAG,gBAAA,CAAGC,MAAA,CAAAC,KAAK,CAACS,MAAM,kBACrBC,mBAAA,UAAa,EACbf,mBAAA,CAIM,OAJNgB,UAIM,I,kBAHFf,mBAAA,CAEOgB,SAAA,QAbnBC,WAAA,CAWmCC,IAAA,CAAAC,OAAO,EAAjBN,MAAM;yBAAnBb,mBAAA,CAEO;MAF0BoB,GAAG,EAAEP,MAAM;MAAGQ,OAAK,EAAAC,MAAA,IAAEJ,IAAA,CAAAK,SAAS,CAACV,MAAM;QAClEd,mBAAA,CAA8E;MAA3ED,KAAK,EAZxB0B,eAAA,EAYyB,YAAY;QAAA,eAA0BX,MAAM,IAAIK,IAAA,CAAAO;MAAa;6CAZtFC,UAAA;oCAeQ3B,mBAAA,CAA2C;IAAlCsB,OAAK,EAAAM,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEV,IAAA,CAAAW,YAAA,IAAAX,IAAA,CAAAW,YAAA,IAAAD,IAAA,CAAY;KAAE,MAAI,GAClC7B,mBAAA,CAAmC;IAA1BsB,OAAK,EAAAM,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEzB,MAAA,CAAA2B,MAAA,IAAA3B,MAAA,CAAA2B,MAAA,IAAAF,IAAA,CAAM;KAAE,IAAE,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}